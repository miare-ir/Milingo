"use strict";(self.webpackChunkmilingo=self.webpackChunkmilingo||[]).push([[231],{"./src/components/chat/styles.scss":function(){},"./src/components/button/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return components_button}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class Button extends react.Component{render(){const{primary:primary,ghost:ghost,link:link,text:text,tiny:tiny,small:small,regular:regular,large:large,danger:danger,shouldRender:shouldRender,...props}=this.props;if(!1===shouldRender)return null;const className=classnames("milingo-btn-wrapper",props.className,{primary:primary,danger:danger,ghost:(ghost||!primary&&!link)&&!danger,link:link,text:text,tiny:tiny,small:small,regular:regular,large:large});return(0,jsx_runtime.jsx)("button",{...props,className:className})}}var components_button=Button},"./src/components/chat/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{en:function(){return chat}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js");__webpack_require__("./src/components/chat/styles.scss");var send=__webpack_require__.p+"static/media/send.82860b853ca61a25b356f7c034035efd.svg";var disabled_send=__webpack_require__.p+"static/media/disabled-send.3fe2c6d0793fd78fc5d8bb9953cfca3b.svg";var icon_attachment=__webpack_require__.p+"static/media/attachment.ce4f68964eca06194d24285f6ac831e9.svg";var attachment_disable=__webpack_require__.p+"static/media/attachment-disable.ca12e5cabd49167a195c7724cfa0e157.svg";var use_previous=value=>{const ref=react.useRef();return react.useEffect((()=>{ref.current=value})),ref.current},components_button=__webpack_require__("./src/components/button/index.tsx"),components_textarea=__webpack_require__("./src/components/textarea/index.tsx");var show=__webpack_require__.p+"static/media/show.60213530d131c81880943ea5d41546fb.svg",modal=__webpack_require__("./src/components/modal/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var chat_attachment=props=>{const prevIsClear=use_previous(props.isClear),[isOpen,toggleModal]=react.useState(!1),clear=()=>{props.disabled||(props.setFile(null),props.onChangeFile&&props.onChangeFile(),props.onFileCancelled&&props.onFileCancelled())};if(react.useEffect((()=>{prevIsClear!==props.isClear&&props.isClear&&clear()}),[props.isClear]),react.useEffect((()=>{}),[isOpen]),props.state&&props.state.message&&!props.validate)throw new TypeError("Please provide either both errorMessage and validate or non of them.");const hasError=(props.forceDisplayError||props.touched)&&props.validate&&!props.validate(props.file),errorMessage=props.state.tryAgain?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:props.state.message}),(0,jsx_runtime.jsx)("span",{onClick:()=>props.onTryAgain(props.file),className:"try-again",children:"(بارگزاری مجدد)"})]}):(0,jsx_runtime.jsx)("p",{children:props.state.message}),className=classnames("file-name-container",{"error-state":hasError,"try-again-state":props.state&&props.state.tryAgain});return(0,jsx_runtime.jsxs)("div",{className:className,children:[(0,jsx_runtime.jsxs)("div",{className:"file-name",children:[(0,jsx_runtime.jsxs)("div",{className:"file-name-text",children:[props.state&&!props.state.progress&&!hasError&&!props.state.tryAgain&&(0,jsx_runtime.jsx)("img",{src:show,className:"show-icon",onClick:()=>toggleModal(!0)}),(0,jsx_runtime.jsx)("p",{children:props.file.name})]}),props.displayClear&&(0,jsx_runtime.jsx)("i",{className:"material-icons clear",onClick:()=>clear(),children:"close"}),props.state&&props.state.progress?(0,jsx_runtime.jsx)("div",{className:"loading-container",children:(0,jsx_runtime.jsx)("div",{className:"loading",style:{width:`${props.state.progress}%`,borderRadius:props.state.progress>98?"8px":""}})}):null]}),hasError&&props.state&&props.state.message&&(0,jsx_runtime.jsx)("div",{className:"error",children:errorMessage}),(0,jsx_runtime.jsx)(modal.Z,{isOpen:isOpen,onClose:()=>toggleModal(!1),className:"milingo-image-modal",children:(0,jsx_runtime.jsx)("img",{src:URL.createObjectURL(props.file)})})]},props.file.name+props.file.size)};var submit_form=_ref=>{let{id:id,isSending:isSending,onSubmit:onSubmit,canAttach:canAttach,onChangeFile:onChangeFile,onTryAgain:onTryAgain,onFileCancelled:onFileCancelled,validate:validate,validFileSize:validFileSize,validFileFormat:validFileFormat,errorInvalidSize:errorInvalidSize,errorInvalidFormat:errorInvalidFormat,footer:footer,state:state,forceDisplayError:forceDisplayError,file:file,isClear:isClear=!1,preMessage:preMessage}=_ref;const[message,setMessage]=react.useState(preMessage),[errorMessage,setErrorMessage]=react.useState(""),[isFileSelect,setIsFileSelect]=react.useState(!!file),[touched,setTouched]=react.useState(!1),[selectedFile,setSelectedFile]=react.useState(null),isSendButtonDisabled=!message&&!isFileSelect||isSending||!!state&&!!state.message||!!errorMessage,[attachment,setAttachment]=react.useState(null),prevFile=use_previous(file),isSizeInvalid=file=>validFileSize&&file.size>validFileSize,isFormatInvalid=file=>validFileFormat&&!validFileFormat.some((format=>file.type===format)),handleSubmitMessage=event=>{null==event||event.preventDefault(),isSendButtonDisabled||onSubmit(id,message,attachment)};react.useEffect((()=>{isClear&&(setAttachment(null),setIsFileSelect(!1),setMessage(""))}),[isClear,attachment]),react.useEffect((()=>{preMessage&&setMessage(preMessage)}),[preMessage]),react.useEffect((()=>{prevFile!==file&&setSelectedFile(file)}),[file]);const handleFileChange=value=>{value?(setIsFileSelect(!0),isSizeInvalid(value)?setErrorMessage(errorInvalidSize||"حجم فایل ارسالی شما بیش از حد مجاز است."):isFormatInvalid(value)?setErrorMessage(errorInvalidFormat||"فرمت فایل ارسالی مناسب نیست"):setErrorMessage("")):setIsFileSelect(!1),setAttachment(value),onChangeFile&&onChangeFile(value)};return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("form",{onSubmit:handleSubmitMessage,className:"submit-form",children:(0,jsx_runtime.jsxs)("div",{className:"chat-actions",children:[isFileSelect&&selectedFile?(0,jsx_runtime.jsx)(chat_attachment,{displayClear:!0,forceDisplayError:forceDisplayError,onChangeFile:handleFileChange,onFileCancelled:onFileCancelled,state:{...state,message:errorMessage||(null==state?void 0:state.message)},onTryAgain:onTryAgain,validate:value=>!isSizeInvalid(value)&&!isFormatInvalid(value)&&(!validate||validate(value)),isClear:isClear,touched:touched,disabled:!!message,file:selectedFile,setFile:setSelectedFile}):(0,jsx_runtime.jsx)(components_textarea.Z,{autoFocus:!0,rows:1,disabled:isSending,value:message,placeholder:"پیام خود را وارد کنید",onChange:event=>setMessage(event.target.value),onKeyDown:event=>{(event.ctrlKey&&"Enter"===event.key||event.shiftKey&&"Enter"===event.key)&&handleSubmitMessage()}}),(0,jsx_runtime.jsxs)("div",{className:"chat-footer",children:[(0,jsx_runtime.jsx)(components_button.Z,{type:"submit",link:!0,tiny:!0,disabled:isSendButtonDisabled,className:"send-button",children:(0,jsx_runtime.jsx)("img",{className:"send-icon",src:isSendButtonDisabled?disabled_send:send})}),(0,jsx_runtime.jsxs)("div",{className:"chat-footer-elements",children:[canAttach&&(0,jsx_runtime.jsxs)(components_button.Z,{className:"attach-button",disabled:!!message,tiny:!0,link:!0,children:[(0,jsx_runtime.jsx)("img",{className:"attach-icon",src:message?attachment_disable:icon_attachment}),(0,jsx_runtime.jsx)("input",{disabled:!!message,type:"file",onChange:event=>{const newFile=Array.from(event.target.files)[0];setTouched(!0),setSelectedFile(newFile),handleFileChange(newFile)},value:""})]}),footer]})]})]})})})};var chat=_ref=>{let{id:id,handelSubmit:handelSubmit,isSending:isSending,isClear:isClear,canSubmit:canSubmit,canAttach:canAttach,children:children,footer:footer,state:state,forceDisplayError:forceDisplayError,file:file,validFileSize:validFileSize,validFileFormat:validFileFormat,errorInvalidFormat:errorInvalidFormat,errorInvalidSize:errorInvalidSize,onChangeFile:onChangeFile,onTryAgain:onTryAgain,onFileCancelled:onFileCancelled,validate:validate,message:message,...rest}=_ref;const componentClassNames=classnames("chat-container",rest.className);return(0,jsx_runtime.jsxs)("div",{...rest,className:componentClassNames,children:[(0,jsx_runtime.jsx)("div",{className:"chat-content",children:children}),canSubmit&&(0,jsx_runtime.jsx)(submit_form,{id:id,isSending:isSending,onSubmit:handelSubmit,canAttach:canAttach,footer:footer,state:state,file:file,onChangeFile:onChangeFile,onTryAgain:onTryAgain,onFileCancelled:onFileCancelled,validate:validate,forceDisplayError:forceDisplayError,isClear:isClear,errorInvalidSize:errorInvalidSize,errorInvalidFormat:errorInvalidFormat,validFileSize:validFileSize,validFileFormat:validFileFormat,preMessage:message})]})};__webpack_require__("./src/components/chat/message.tsx")},"./src/components/chat/message.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),react_linkify__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-linkify/dist/index.js"),_image__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/image/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./src/components/chat/styles.scss"),__webpack_require__("./node_modules/react/jsx-runtime.js"));__webpack_exports__.Z=props=>{const componentClassNames=classnames__WEBPACK_IMPORTED_MODULE_1__("chat-message-container",props.isRight?"right":"left",props.className);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:componentClassNames,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"chat-message-item",children:props.isImage?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_image__WEBPACK_IMPORTED_MODULE_3__.Z,{src:props.message,alt:"attached-image",className:"attached-image",thumbnailInfo:{originalSrc:props.message}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react_linkify__WEBPACK_IMPORTED_MODULE_2__.Z,{properties:{target:"_blank"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("p",{className:"message-content",children:props.message})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("span",{className:"time",children:(dateTime=props.createdDate,props.timeFormat?new Intl.DateTimeFormat("fa",props.timeFormat).format(new Date(dateTime)):new Intl.DateTimeFormat("fa",{hour:"2-digit",minute:"2-digit"}).format(new Date(dateTime)))})]},props.id);var dateTime}},"./src/components/image/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return components_image}});var react=__webpack_require__("./node_modules/react/index.js"),modal=__webpack_require__("./src/components/modal/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var components_image=_ref=>{let{src:src,alt:alt,thumbnailInfo:thumbnailInfo,...rest}=_ref;const[isOpen,toggleModal]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("img",{loading:"lazy",src:src,alt:alt,onLoad:event=>event.target.classList.add("image-loaded"),onError:event=>event.target.classList.add("image-has-error"),onClick:()=>{if(thumbnailInfo.originalSrc)return toggleModal(!0)},...rest}),(0,jsx_runtime.jsx)(modal.Z,{isOpen:isOpen,onClose:()=>toggleModal(!1),className:"milingo-image-modal",children:(0,jsx_runtime.jsx)("img",{src:null==thumbnailInfo?void 0:thumbnailInfo.originalSrc,alt:null==thumbnailInfo?void 0:thumbnailInfo.originalAlt})})]})}},"./src/components/modal/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return modal}});var react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var modal=props=>{var _props$overlayClassNa;const closeOnEscapeKeyDown=event=>{27===(event.charCode||event.keyCode)&&props.onClose()};(0,react.useEffect)((()=>(props.onClose&&document.body.addEventListener("keydown",closeOnEscapeKeyDown),function cleanup(){props.onClose&&document.body.removeEventListener("keydown",closeOnEscapeKeyDown)})),[]);return props.isOpen?(0,jsx_runtime.jsx)("div",{className:`milingo-modal--overlay ${props.isOpen?"isOpen":""} ${null!==(_props$overlayClassNa=props.overlayClassName)&&void 0!==_props$overlayClassNa?_props$overlayClassNa:""}`,onClick:()=>{props.onClose&&props.onClose()},children:(0,jsx_runtime.jsx)("div",{className:`modal modal-content ${props.align} ${props.className}`,onClick:event=>event.stopPropagation(),children:props.children})}):null}},"./src/components/textarea/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return components_textarea}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class Textarea extends react.Component{constructor(props){super(props),this.handleInput=e=>{e.target.value!==this.state.value&&(this.state.touched?this.setState({value:e.target.value}):this.setState({touched:!0,value:e.target.value})),this.props.onChange&&this.props.onChange(e)},this.state={touched:!1,value:props.value||""}}static getDerivedStateFromProps(nextProps,prevState){return nextProps.value!==prevState.value?{value:nextProps.value}:null}render(){if(this.props.errorMessage&&!this.props.validate)throw new TypeError("Please provide either both errorMessage and validate or non of them.");const{errorMessage:errorMessage,forceDisplayError:forceDisplayError,validate:validate,title:title,className:className,...props}=this.props,hasError=errorMessage&&(forceDisplayError||this.state.touched)&&!validate(this.state.value),componentClassName=classnames("textarea-container",className,{error:hasError});return(0,jsx_runtime.jsxs)("div",{className:componentClassName,children:[title&&(0,jsx_runtime.jsx)("label",{htmlFor:props.id||"",children:title}),(0,jsx_runtime.jsx)("textarea",{cols:this.props.cols,rows:this.props.rows,value:this.state.value,onChange:this.handleInput,...props}),hasError&&(0,jsx_runtime.jsx)("span",{className:"error",children:errorMessage})]})}}var components_textarea=Textarea}}]);