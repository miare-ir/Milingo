/*! For license information please see file-input-wrapper-index-stories.2174aab9.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkmilingo=self.webpackChunkmilingo||[]).push([[228],{"./node_modules/classnames/index.js":function(module,exports){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}}else if("object"===argType){if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes("[native code]")){classes.push(arg.toString());continue}for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},"./src/components/button/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return components_button}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class Button extends react.Component{render(){const{primary:primary,ghost:ghost,link:link,text:text,tiny:tiny,small:small,regular:regular,large:large,danger:danger,shouldRender:shouldRender,purplePrimary:purplePrimary,purpleGhost:purpleGhost,purpleLink:purpleLink,...props}=this.props;if(!1===shouldRender)return null;const className=classnames("milingo-btn-wrapper",props.className,{primary:primary,danger:danger,ghost:(ghost||!primary&&!link)&&!danger,link:link,text:text,tiny:tiny,small:small,regular:regular,large:large,purplePrimary:purplePrimary,purpleGhost:purpleGhost,purpleLink:purpleLink});return(0,jsx_runtime.jsx)("button",{...props,className:className})}}var components_button=Button},"./src/components/dialog-content/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return dialog_content}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class DialogContent extends react.Component{componentDidMount(){if(this.props.primary&&this.props.secondary)throw new Error("Dialog content component can't receive primary and secondary props at same time ");if(!this.props.primary&&!this.props.secondary)throw new Error("Dialog content component needs one of primary or secondary props")}render(){const{className:className,title:title,primary:primary,secondary:secondary,actions:actions,children:children,onClose:onClose,titleDescription:titleDescription,...props}=this.props,componentClassNames=classnames("dialog-content-wrapper",className,{primary:primary,secondary:secondary});return(0,jsx_runtime.jsxs)("div",{className:componentClassNames,...props,children:[(0,jsx_runtime.jsx)("div",{className:"dialog-header",children:(0,jsx_runtime.jsxs)("h2",{className:"dialog-title",children:[(0,jsx_runtime.jsx)("span",{onClick:onClose,className:"material-icons",children:"close"}),(0,jsx_runtime.jsx)("span",{children:title}),(0,jsx_runtime.jsx)("span",{className:"dialog-title-description",children:titleDescription})]})},"title"),children&&(0,jsx_runtime.jsx)("div",{className:"dialog-content",children:children},"content"),(0,jsx_runtime.jsx)("div",{className:"dialog-actions",children:actions},"footer")]})}}var dialog_content=DialogContent},"./src/components/file-input-wrapper/index.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{_FileInputWrapper:function(){return _FileInputWrapper},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return index_stories}});var react=__webpack_require__("./node_modules/react/index.js"),file_input_wrapper=__webpack_require__("./src/components/file-input-wrapper/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var index_stories={title:"File Input Wrapper",component:file_input_wrapper.Z};const _FileInputWrapper=()=>{const[video,setVideo]=react.useState();return(0,jsx_runtime.jsxs)("div",{className:"file-input-wrapper-story",children:[(0,jsx_runtime.jsx)("h1",{children:"Image uploader:"}),(0,jsx_runtime.jsx)(file_input_wrapper.Z,{wrapperTitle:"عکس پروفایل",description:"یک عکس برای پروفایل خود انتخاب کنید",maxFileSize:2e6,hint:{children:"content",title:"راهنمای عکاسی"},displayClear:!0,forceDisplayError:!0}),(0,jsx_runtime.jsx)("h1",{children:"Video uploader:"}),(0,jsx_runtime.jsx)(file_input_wrapper.Z,{wrapperTitle:"ویدیو احراز هویت",description:"از خودت فیلم بگیر و خودتو معرفی کن",uploadFileText:"بارگذاری ویدیو",uploaderType:"video",displayClear:!0,forceDisplayError:!0,onFileChange:()=>setVideo("https://www.w3schools.com/tags/movie.mp4"),defaultFilePath:video,states:{0:{loading:!0,progress:70}},hint:{children:"content",title:"راهنمای عکاسی"}})]})},__namedExportsOrder=["_FileInputWrapper"]},"./src/components/file-input-wrapper/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return file_input_wrapper}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),components_button=__webpack_require__("./src/components/button/index.tsx"),components_image=__webpack_require__("./src/components/image/index.tsx"),loader=__webpack_require__("./src/components/loader/index.tsx"),file_input=__webpack_require__("./src/components/file-input/index.tsx"),dialog_content=__webpack_require__("./src/components/dialog-content/index.tsx"),modal=__webpack_require__("./src/components/modal/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var upload_hint=_ref=>{var _modalProps$className;let{children:children,title:title,cancelText:cancelText,selectText:selectText,isHintModalOpen:isHintModalOpen,setIsHintModalOpen:setIsHintModalOpen,onSelect:onSelect,modalProps:modalProps}=_ref;return(0,jsx_runtime.jsx)(modal.Z,{overlayClassName:"file-input-hint-overlay",isOpen:isHintModalOpen,className:`file-input-hint ${null!==(_modalProps$className=null==modalProps?void 0:modalProps.className)&&void 0!==_modalProps$className?_modalProps$className:""}`,...modalProps,onClose:()=>setIsHintModalOpen(!1),children:(0,jsx_runtime.jsx)(dialog_content.Z,{title:title,onClose:()=>setIsHintModalOpen(!1),primary:!0,actions:[(0,jsx_runtime.jsx)(components_button.Z,{primary:!0,small:!0,onClick:onSelect,type:"button",children:null!=selectText?selectText:"انتخاب عکس"},0),(0,jsx_runtime.jsx)(components_button.Z,{ghost:!0,small:!0,onClick:()=>setIsHintModalOpen(!1),type:"button",children:null!=cancelText?cancelText:"انصراف"},1)],children:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:children})})})};class Img{}Img.resize=async function(image){let scaleOrCustom=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{newSizeOrScale:.5,sizeOrScale:"scale",target:"width"},onError=arguments.length>2?arguments[2]:void 0;try{return await(async()=>new Promise((async(resolve,reject)=>{const _image="string"==typeof image?image:await Img.toBase64(image,reject);if(!_image)return null;const sizes=await Img.getSizes(_image,reject);if(!sizes)return;const{width:defaultWidth,height:defaultHeight}=sizes,{width:newWidth,height:newHeight}=Img.calculateSize(defaultWidth,defaultHeight,scaleOrCustom),canvas=document.createElement("canvas");canvas.width=newWidth,canvas.height=newHeight;const context=canvas.getContext("2d");if(!context)return;const img=await Img.base64ToImage(_image,reject);img&&(context.drawImage(img,0,0,newWidth,newHeight),resolve(canvas.toDataURL()))})))()}catch(error){return null==onError||onError(error),null}},Img.decreaseToFixedWeight=async(image,maxSize,decreaseSteps,fileName)=>{const isFile="string"!=typeof image,{width:width}=await Img.getSizes(image);decreaseSteps=decreaseSteps||100,isFile&&!fileName&&(fileName=image.name);const originalFile=isFile?image:await Img.base64ToFile(image,fileName);if(originalFile.size<=maxSize)return{image:isFile?await Img.toBase64(image):image,file:originalFile};const compressedBase64=await Img.resize(image,{newSizeOrScale:width-decreaseSteps,sizeOrScale:"size",target:"width"}),compressedFile=await Img.base64ToFile(compressedBase64,fileName);return compressedFile.size>maxSize?Img.decreaseToFixedWeight(compressedBase64,maxSize,decreaseSteps,fileName):{image:compressedBase64,file:compressedFile}},Img.toBase64=async(imageFile,onError)=>{try{return await new Promise(((resolve,reject)=>{const reader=new FileReader;reader.readAsDataURL(imageFile),reader.onload=()=>resolve(reader.result),reader.onerror=reject}))}catch(error){return null==onError||onError(error),null}},Img.base64ToImage=async(base64,onError)=>{try{return await new Promise(((resolve,reject)=>{const image=new Image;image.src=base64,image.onload=()=>resolve(image),image.onerror=(_0,_1,_2,_3,error)=>reject(error)}))}catch(error){return null==onError||onError(error),null}},Img.base64ToFile=async(base64,fileName)=>{const res=await fetch(base64),blob=await res.blob();return new File([blob],fileName,{type:"image/png"})},Img.getSizes=async(image,onError)=>{const base64Image="string"==typeof image?image:await Img.toBase64(image,onError);if(!base64Image)return null;try{return await new Promise((function(resolve,reject){const newImage=new Image;newImage.onload=()=>resolve(newImage),newImage.onerror=(_0,_1,_2,_3,error)=>reject(error),newImage.src=base64Image}))}catch(error){return null==onError||onError(error),null}},Img.calculateSize=(defaultWidth,defaultHeight,scaleOrCustom)=>{const{newSizeOrScale:newSizeOrScale,sizeOrScale:sizeOrScale,target:target}=scaleOrCustom;let width=defaultWidth,height=defaultHeight;switch(sizeOrScale){case"scale":width=defaultWidth/newSizeOrScale,height=defaultHeight/newSizeOrScale;break;case"size":"width"===target?defaultWidth>newSizeOrScale&&(width=newSizeOrScale,height=defaultHeight*newSizeOrScale/defaultWidth):defaultHeight>newSizeOrScale&&(height=newSizeOrScale,width=defaultWidth*newSizeOrScale/defaultHeight)}return{width:width,height:height}};var utils_image=Img;var file_input_wrapper=_ref=>{var _fileInputProps$state,_containerProps$class;let{wrapperTitle:wrapperTitle,description:description,hint:hint,defaultFilePath:defaultFilePath,videoProps:videoProps,buttonProps:buttonProps,uploadFileText:uploadFileText="بارگذاری عکس",maxFileSize:maxFileSize=1e7,decreaseImageSizeSteps:decreaseImageSizeSteps=500,onFileChange:onFileChange,fileName:fileName,disabled:disabled,imageProps:imageProps,uploaderType:uploaderType="image",hintModalProps:hintModalProps,containerProps:containerProps,...fileInputProps}=_ref;const inputRef=react.useRef(null),[isHintModalOpen,setIsHintModalOpen]=react.useState(!1),[isResizing,setIsResizing]=react.useState(!1),[filePath,setFilePath]=react.useState(defaultFilePath),[previewFileName,setPreviewFileName]=react.useState(fileName),progressState=(null==fileInputProps||null===(_fileInputProps$state=fileInputProps.states)||void 0===_fileInputProps$state?void 0:_fileInputProps$state[0])||{loading:!1,progress:0},fileInputClasses=classnames("uploader-input",{visible:!isResizing&&progressState.loading}),openFileDialog=()=>{var _inputRef$current;hint&&!isHintModalOpen?setIsHintModalOpen(!0):null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current||_inputRef$current.click()};react.useEffect((()=>{setFilePath(defaultFilePath)}),[defaultFilePath]),react.useEffect((()=>{setPreviewFileName(fileName)}),[fileName]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[hint&&(0,jsx_runtime.jsx)(upload_hint,{...hint,isHintModalOpen:isHintModalOpen,setIsHintModalOpen:setIsHintModalOpen,onSelect:openFileDialog,modalProps:hintModalProps}),(0,jsx_runtime.jsxs)("div",{...containerProps,className:`file-input-wrapper ${null!==(_containerProps$class=null==containerProps?void 0:containerProps.className)&&void 0!==_containerProps$class?_containerProps$class:""}`,children:[wrapperTitle&&(0,jsx_runtime.jsx)("h4",{className:"wrapper-title",children:wrapperTitle}),description&&(0,jsx_runtime.jsx)("h4",{className:"wrapper-description",children:description}),(0,jsx_runtime.jsxs)("div",{className:"uploader-container",children:[filePath&&!progressState.loading?(()=>{switch(uploaderType){case"image":return(0,jsx_runtime.jsxs)("div",{className:"previewer image-preview",children:[(0,jsx_runtime.jsx)(components_image.Z,{...imageProps,src:filePath,className:"image"}),(0,jsx_runtime.jsx)("div",{className:"image-info",children:(0,jsx_runtime.jsx)("p",{className:"image-name",children:previewFileName})})]});case"video":return(0,jsx_runtime.jsx)("div",{className:"previewer video-preview",children:(0,jsx_runtime.jsx)("video",{className:"video",controls:!0,...videoProps,src:filePath})})}})():(0,jsx_runtime.jsxs)("div",{className:"uploader-description",children:[(0,jsx_runtime.jsx)("span",{className:"material-icons upload-icon",children:"cloud_upload"}),(0,jsx_runtime.jsx)("p",{className:"uploader-title",children:uploadFileText})]}),!progressState.loading&&(0,jsx_runtime.jsx)(components_button.Z,{...buttonProps,className:"uploader-button",disabled:isResizing||disabled,type:"button",onClick:openFileDialog,children:isResizing?(0,jsx_runtime.jsx)(loader.Z,{primary:!0}):filePath?"تغییر":"انتخاب"}),(0,jsx_runtime.jsx)(file_input.Z,{...fileInputProps,className:fileInputClasses,files:[new File([""],fileName)],inputRef:inputRef,onChangeFiles:files=>{const file=files[0];if(file){const type=(file=>file.type.split("/")[0])(file);switch(type){case"image":return(file=>{setIsResizing(!0),setIsHintModalOpen(!1),utils_image.decreaseToFixedWeight(file,maxFileSize,decreaseImageSizeSteps).then((compressed=>{setIsResizing(!1),setFilePath(compressed.image),null==onFileChange||onFileChange(compressed.file),setPreviewFileName(compressed.file.name)}))})(file);case"video":return(file=>{setIsHintModalOpen(!1),null==onFileChange||onFileChange(file)})(file)}}}})]})]})]})}},"./src/components/file-input/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return file_input}});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),components_button=__webpack_require__("./src/components/button/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");class FileInput extends react.Component{constructor(props){super(props),this.handleInput=e=>{const newFiles=Array.from(e.target.files);this.setState({touched:!0,files:this.props.multiple?this.state.files.concat(newFiles):newFiles}),this.props.onChangeFiles&&this.props.onChangeFiles(this.props.multiple?this.state.files.concat(newFiles):newFiles)},this.clear=index=>{this.props.disabled||(index?(this.setState({files:this.state.files.filter(((_,filterIndex)=>index!==filterIndex))}),this.props.onChangeFiles&&this.props.onChangeFiles(this.state.files.filter(((_,filterIndex)=>index!==filterIndex))),this.props.onFileCancelled&&this.props.onFileCancelled(index)):(this.setState({files:null}),this.props.onChangeFiles&&this.props.onChangeFiles([]),this.props.onFileCancelled&&this.props.onFileCancelled()))},this.renderFiles=(state,file,index)=>{if(state&&state.message&&!this.props.validate)throw new TypeError("Please provide either both errorMessage and validate or non of them.");const hasError=(this.props.forceDisplayError||this.state.touched)&&this.props.validate&&!this.props.validate(this.state.files),className=classnames("file-name-container",{"error-state":hasError,"try-again-state":state&&state.tryAgain});return(0,jsx_runtime.jsxs)("div",{className:className,children:[(0,jsx_runtime.jsxs)("div",{className:"file-name",children:[(0,jsx_runtime.jsxs)("div",{className:"file-name-text",children:[(0,jsx_runtime.jsx)("p",{children:file.name}),this.props.displayClear&&(0,jsx_runtime.jsx)("i",{className:"material-icons clear",onClick:()=>this.clear(index),children:"close"})]}),state&&state.tryAgain&&(0,jsx_runtime.jsx)("div",{onClick:()=>this.props.onTryAgain(this.state.files),className:"try-again",children:this.props.tryAgainText?this.props.tryAgainText:"تلاش مجدد"}),state&&state.progress?(0,jsx_runtime.jsx)("div",{className:"loading-container",children:(0,jsx_runtime.jsx)("div",{className:"loading",style:{width:`${state.progress}%`}})}):null]}),hasError&&state&&state.message&&(0,jsx_runtime.jsx)("span",{className:"error",children:state.message})]},file.name+file.size)},this.state={touched:!1,files:props.files||null}}componentDidUpdate(prevProps){prevProps.files!==this.props.files&&this.setState({files:prevProps.files}),prevProps.isClear!==this.props.isClear&&this.props.isClear&&this.clear()}render(){const{forceDisplayError:forceDisplayError,validate:validate,displayClear:displayClear,title:title,pre:pre,disabled:disabled,states:states,children:children,className:className,onChangeFiles:onChangeFiles,onTryAgain:onTryAgain,onFileCancelled:onFileCancelled,tryAgainText:tryAgainText,isClear:isClear,inputRef:inputRef,...props}=this.props,{files:files}=this.state,componentClassName=classnames("file-container",className,{multiple:this.props.multiple});return(0,jsx_runtime.jsx)("div",{className:componentClassName,children:(0,jsx_runtime.jsxs)("div",{className:"file-div",children:[files&&files.length>0&&files.map(((file,index)=>this.renderFiles(states&&states[index],file,index))),(0,jsx_runtime.jsxs)(components_button.Z,{disabled:disabled,primary:!0,children:[children||"افزودن فایل",(0,jsx_runtime.jsx)("input",{disabled:disabled,type:"file",ref:inputRef,onChange:this.handleInput,value:"",...props})]})]})})}}var file_input=FileInput},"./src/components/image/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return components_image}});var react=__webpack_require__("./node_modules/react/index.js"),modal=__webpack_require__("./src/components/modal/index.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var components_image=_ref=>{let{src:src,alt:alt,thumbnailInfo:thumbnailInfo,...rest}=_ref;const[isOpen,toggleModal]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("img",{loading:"lazy",src:src,alt:alt,onLoad:event=>event.target.classList.add("image-loaded"),onError:event=>event.target.classList.add("image-has-error"),onClick:()=>{if(null!=thumbnailInfo&&thumbnailInfo.originalSrc)return toggleModal(!0)},...rest}),(0,jsx_runtime.jsx)(modal.Z,{isOpen:isOpen,onClose:()=>toggleModal(!1),className:"milingo-image-modal",children:(0,jsx_runtime.jsx)("img",{src:null==thumbnailInfo?void 0:thumbnailInfo.originalSrc,alt:null==thumbnailInfo?void 0:thumbnailInfo.originalAlt})})]})}},"./src/components/loader/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return loader}});__webpack_require__("./node_modules/react/index.js");var classnames=__webpack_require__("./node_modules/classnames/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var loader=_ref=>{let{primary:primary,danger:danger,disabled:disabled}=_ref;const className=classnames("spinner",{"spinner-primary":primary,"spinner-danger":danger,"spinner-disabled":disabled});return(0,jsx_runtime.jsx)("span",{className:className})}},"./src/components/modal/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return modal}});var react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var modal=props=>{var _props$overlayClassNa;const closeOnEscapeKeyDown=event=>{27===(event.charCode||event.keyCode)&&props.onClose()};(0,react.useEffect)((()=>(props.onClose&&document.body.addEventListener("keydown",closeOnEscapeKeyDown),function cleanup(){props.onClose&&document.body.removeEventListener("keydown",closeOnEscapeKeyDown)})),[]);return props.isOpen?(0,jsx_runtime.jsx)("div",{className:`milingo-modal--overlay ${props.isOpen?"isOpen":""} ${null!==(_props$overlayClassNa=props.overlayClassName)&&void 0!==_props$overlayClassNa?_props$overlayClassNa:""}`,onClick:()=>{props.onClose&&props.onClose()},children:(0,jsx_runtime.jsx)("div",{className:`modal modal-content ${props.align} ${props.className}`,onClick:event=>event.stopPropagation(),children:props.children})}):null}},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")}}]);